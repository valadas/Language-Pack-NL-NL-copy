name: Release
on:
  push:
    branches:
      - master

jobs:
  release:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
      
    - name: Dump GitHub context
      env:
        GITHUB_CONTEXT: ${{ toJson(github) }}
      run: echo "$GITHUB_CONTEXT"
      
    - name: get-version-from-dnn-manifest
      uses: valadas/get-version-from-dnn-manifest@v1
      id: version
      
    - name: Zip Release
      run: cd Resources && zip -r release_$VERSION.zip *
      env:
        VERSION: ${{ steps.version.outputs.versionString }}

    - name: Create Release
      uses: ncipollo/release-action@v1.6.1
      with:
        artifacts: Resources/*.zip
        body: Dnn Language pack
        tag: ${{ steps.version.outputs.major }}.${{ steps.version.outputs.minor }}.${{ steps.version.outputs.patch }}
        # The Github token.
        token: ${{ secrets.GITHUB_TOKEN }}
